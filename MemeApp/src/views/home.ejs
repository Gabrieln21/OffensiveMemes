<!-- Tailwind CSS via CDN (for development only) -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    theme: {
      extend: {
        keyframes: {
          wiggle: {
            '0%, 100%': { transform: 'rotate(-3deg)' },
            '50%': { transform: 'rotate(3deg)' },
          },
          float: {
            '0%, 100%': { transform: 'translateY(0)' },
            '50%': { transform: 'translateY(-20px)' },
          },
          pulse3D: {
            '0%, 100%': { transform: 'scale3d(1, 1, 1)' },
            '50%': { transform: 'scale3d(1.05, 1.05, 1.05)' },
          },
          sparkle: {
            '0%, 100%': { opacity: 1 },
            '50%': { opacity: 0.4 }
          },
          neonPulse: {
            '0%, 100%': {
              'box-shadow': '0 0 20px #ff0000, 0 0 40px #ff0000, 0 0 60px #ff0000',
              transform: 'scale(1)'
            },
            '50%': {
              'box-shadow': '0 0 25px #ff4444, 0 0 50px #ff4444, 0 0 75px #ff4444',
              transform: 'scale(1.02)'
            }
          },
          rotateCard: {
            '0%': { transform: 'rotate(0deg) translateY(0)' },
            '25%': { transform: 'rotate(90deg) translateY(-10px)' },
            '50%': { transform: 'rotate(180deg) translateY(-20px)' },
            '75%': { transform: 'rotate(270deg) translateY(-10px)' },
            '100%': { transform: 'rotate(360deg) translateY(0)' },
          }
        },
        animation: {
          wiggle: 'wiggle 1s ease-in-out infinite',
          float: 'float 3s ease-in-out infinite',
          pulse3D: 'pulse3D 2s ease-in-out infinite',
          sparkle: 'sparkle 2s ease-in-out infinite',
          neonPulse: 'neonPulse 2s ease-in-out infinite',
          rotateCard: 'rotateCard 3s linear infinite'
        }
      }
    }
  }
</script>

<div class="relative min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-purple-800 via-fuchsia-900 to-black text-white">
    <!-- Login Button -->
    <div class="absolute top-6 right-6 z-10 flex flex-col space-y-2 items-end">
        <% if (!locals.user) { %>
            <!-- Sign Up Button -->
            <a href="/auth/signup" class="group relative inline-flex items-center justify-center overflow-hidden rounded-2xl p-[3px] hover:cursor-pointer">
                <div class="absolute inset-0 rounded-2xl bg-gradient-to-r from-red-600 via-yellow-500 to-red-600 group-hover:bg-gradient-to-r group-hover:from-red-500 group-hover:via-yellow-400 group-hover:to-red-500 transition-all duration-300 animate-border-flow"></div>
                <div class="relative flex items-center space-x-2 bg-black px-6 py-2 rounded-xl transition-all duration-400 ease-out group-hover:bg-black/90">
                    <i class="fas fa-user-plus text-md text-white group-hover:rotate-12 transition-transform duration-300"></i>
                    <span class="relative bg-gradient-to-r from-white to-gray-100 bg-clip-text text-sm font-bold text-transparent">SIGN UP</span>
                </div>
            </a>
    
            <!-- Login Button -->
            <a href="/auth/login" class="group relative inline-flex items-center justify-center overflow-hidden rounded-2xl p-[3px] hover:cursor-pointer">
                <div class="absolute inset-0 rounded-2xl bg-gradient-to-r from-red-600 via-yellow-500 to-red-600 group-hover:bg-gradient-to-r group-hover:from-red-500 group-hover:via-yellow-400 group-hover:to-red-500 transition-all duration-300 animate-border-flow"></div>
                <div class="relative flex items-center space-x-2 bg-black px-6 py-2 rounded-xl transition-all duration-400 ease-out group-hover:bg-black/90">
                    <i class="fas fa-sign-in-alt text-md text-white group-hover:rotate-12 transition-transform duration-300"></i>
                    <span class="relative bg-gradient-to-r from-white to-gray-100 bg-clip-text text-sm font-bold text-transparent">LOGIN</span>
                </div>
            </a>
        <% } else { %>
            <!-- Logout Button -->
            <form action="/auth/logout" method="POST" class="w-fit">
                <button type="submit" class="group relative inline-flex items-center justify-center overflow-hidden rounded-2xl p-[3px] hover:cursor-pointer">
                    <div class="absolute inset-0 rounded-2xl bg-gradient-to-r from-red-600 via-yellow-500 to-red-600 group-hover:bg-gradient-to-r group-hover:from-red-500 group-hover:via-yellow-400 group-hover:to-red-500 transition-all duration-300 animate-border-flow"></div>
                    <div class="relative flex items-center space-x-2 bg-black px-6 py-2 rounded-xl transition-all duration-400 ease-out group-hover:bg-black/90">
                        <i class="fas fa-sign-out-alt text-md text-white group-hover:rotate-12 transition-transform duration-300"></i>
                        <span class="relative bg-gradient-to-r from-white to-gray-100 bg-clip-text text-sm font-bold text-transparent">LOGOUT</span>
                    </div>
                </button>
            </form>
    
            <!-- View Profile Button -->
            <a href="/profile" class="group relative inline-flex items-center justify-center overflow-hidden rounded-2xl p-[3px] hover:cursor-pointer">
                <div class="absolute inset-0 rounded-2xl bg-gradient-to-r from-red-600 via-yellow-500 to-red-600 group-hover:bg-gradient-to-r group-hover:from-red-500 group-hover:via-yellow-400 group-hover:to-red-500 transition-all duration-300 animate-border-flow"></div>
                <div class="relative flex items-center space-x-2 bg-black px-6 py-2 rounded-xl transition-all duration-400 ease-out group-hover:bg-black/90">
                    <i class="fas fa-user text-md text-white group-hover:rotate-12 transition-transform duration-300"></i>
                    <span class="relative bg-gradient-to-r from-white to-gray-100 bg-clip-text text-sm font-bold text-transparent">PROFILE</span>
                </div>
            </a>
            <!-- Notifications Bell -->
            <div id="notificationWrapper" class="relative mt-2">
                <button id="notificationBell" class="text-white text-xl hover:text-yellow-300 relative">
                ðŸ””
                <span id="notificationDot" class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full hidden"></span>
                </button>
                <div id="notificationDropdown" class="absolute right-0 mt-2 w-80 bg-black/90 rounded-lg shadow-xl hidden z-50 text-sm">
                <div class="p-3 font-bold border-b border-purple-600 text-purple-300">Notifications</div>
                <div id="notificationList" class="max-h-64 overflow-y-auto divide-y divide-purple-700">
                    <div class="p-3 text-gray-400">Loading...</div>
                </div>
                </div>
            </div>
  
        <% } %>
    </div>
    

    <div class="container mx-auto flex items-center justify-center min-h-[85vh] p-8">
        <div class="w-full max-w-4xl text-center">
            <div class="mb-12 animate-fade-in">
                <div class="relative inline-block">
                    <h1 class="text-7xl font-black mb-6 bg-gradient-to-r from-red-400 via-white to-red-400 bg-clip-text text-transparent tracking-wider drop-shadow-2xl">Meme Battle</h1>
                    <div class="absolute -top-8 -right-8 w-16 h-16 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full blur-xl opacity-70 animate-pulse"></div>
                </div>
                <p class="text-2xl text-gray-300 tracking-wide font-light">Create hilarious memes and battle with friends in this epic meme-making showdown!</p>
            </div>

            <div class="bg-black/30 backdrop-blur-lg border border-white/10 rounded-3xl p-10 mb-12 transform transition-all duration-300 hover:scale-[1.02] hover:-translate-y-2 hover:shadow-2xl relative overflow-hidden">
                <!-- Floating Meme Elements Background -->
                <div class="absolute inset-0 overflow-hidden pointer-events-none">
                    <div class="absolute -top-4 left-10 w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full rotate-12 animate-float opacity-30"></div>
                    <div class="absolute top-1/4 right-10 w-16 h-16 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full -rotate-12 animate-float opacity-30" style="animation-delay: 1s;"></div>
                    <div class="absolute bottom-10 left-20 w-16 h-16 bg-gradient-to-br from-green-500 to-teal-500 rounded-full rotate-45 animate-float opacity-30" style="animation-delay: 2s;"></div>
                </div>
                <div class="flex flex-col space-y-12 relative">
                    <!-- Play Now Button -->
                    <a href="/games" class="group relative bg-black/50 text-white font-bold py-10 px-12 rounded-2xl flex items-center justify-center transform transition-all duration-500 hover:scale-110 animate-pulse3D overflow-hidden">
                        <!-- Neon border effect -->
                        <div class="absolute inset-0 rounded-2xl animate-neonPulse opacity-0 group-hover:opacity-100"></div>

                        <!-- Floating cards effect -->
                        <div class="absolute -left-4 top-1/2 -translate-y-1/2 w-10 h-14 bg-red-500 rounded-lg opacity-0 group-hover:opacity-100 transition-all duration-500 animate-rotateCard"></div>
                        <div class="absolute -right-4 top-1/2 -translate-y-1/2 w-10 h-14 bg-blue-500 rounded-lg opacity-0 group-hover:opacity-100 transition-all duration-500 animate-rotateCard" style="animation-delay: 0.5s;"></div>

                        <!-- Content -->
                        <div class="relative flex items-center space-x-6">
                            <i class="fas fa-play-circle text-5xl group-hover:animate-bounce text-red-500"></i>
                            <div>
                                <span class="block text-3xl font-black tracking-wider bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent">CREATE MEMES</span>
                                <span class="text-sm text-purple-400 tracking-widest animate-pulse">BATTLE WITH FRIENDS!</span>
                            </div>
                        </div>

                        <!-- Sparkling stars -->
                        <div class="absolute inset-0">
                            <div class="absolute top-2 left-1/4 w-1 h-1 bg-white rounded-full animate-sparkle"></div>
                            <div class="absolute bottom-2 right-1/4 w-1 h-1 bg-white rounded-full animate-sparkle" style="animation-delay: 0.5s;"></div>
                            <div class="absolute top-1/2 right-4 w-1 h-1 bg-white rounded-full animate-sparkle" style="animation-delay: 1s;"></div>
                        </div>
                    </a>

                    <!-- Leaderboards Button -->
                    <a href="/leaderboard" class="group relative bg-black/50 text-white font-bold py-10 px-12 rounded-2xl flex items-center justify-center transform transition-all duration-500 hover:scale-110 overflow-hidden">
                        <!-- Trophy pedestal effect -->
                        <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-32 h-1 bg-gradient-to-r from-transparent via-yellow-400 to-transparent group-hover:animate-pulse"></div>

                        <!-- Floating crowns -->
                        <div class="absolute -top-4 left-1/4 text-yellow-400 opacity-0 group-hover:opacity-100 transition-all duration-500 group-hover:-translate-y-8">
                            <i class="fas fa-crown text-xl animate-float"></i>
                        </div>
                        <div class="absolute -top-4 right-1/4 text-yellow-400 opacity-0 group-hover:opacity-100 transition-all duration-500 group-hover:-translate-y-8" style="animation-delay: 0.3s;">
                            <i class="fas fa-crown text-xl animate-float"></i>
                        </div>

                        <!-- Content -->
                        <div class="relative flex items-center space-x-6">
                            <i class="fas fa-trophy text-5xl text-yellow-400 group-hover:animate-wiggle"></i>
                            <div>
                                <span class="block text-3xl font-black tracking-wider bg-gradient-to-r from-yellow-400 to-yellow-600 bg-clip-text text-transparent">LEADERBOARDS</span>
                                <span class="text-sm text-yellow-400 tracking-widest">CLAIM YOUR CROWN</span>
                            </div>
                        </div>

                        <!-- Sparkle effect -->
                        <div class="absolute inset-0 bg-gradient-to-r from-yellow-600/0 via-yellow-600/30 to-yellow-600/0 opacity-0 group-hover:opacity-100 animate-pulse"></div>
                    </a>

                    <!-- Rules Button -->
                    <a href="/rules" class="group relative bg-black/50 text-white font-bold py-10 px-12 rounded-2xl flex items-center justify-center transform transition-all duration-500 hover:scale-110 overflow-hidden">
                        <!-- Magic book effect -->
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-600/0 via-blue-600/20 to-blue-600/0 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>

                        <!-- Floating pages effect -->
                        <div class="absolute inset-0">
                            <div class="absolute top-1/4 left-1/4 w-8 h-8 border-t border-r border-blue-400/30 rounded-tr-lg opacity-0 group-hover:opacity-100 transition-all duration-500 group-hover:-translate-y-full group-hover:rotate-45"></div>
                            <div class="absolute bottom-1/4 right-1/4 w-8 h-8 border-b border-l border-blue-400/30 rounded-bl-lg opacity-0 group-hover:opacity-100 transition-all duration-500 group-hover:translate-y-full group-hover:-rotate-45"></div>
                        </div>

                        <!-- Content -->
                        <div class="relative flex items-center space-x-6">
                            <i class="fas fa-book-open text-5xl text-blue-400 group-hover:animate-float"></i>
                            <div>
                                <span class="block text-3xl font-black tracking-wider bg-gradient-to-r from-blue-400 to-blue-600 bg-clip-text text-transparent">HOW TO PLAY</span>
                                <span class="text-sm text-blue-400 tracking-widest">BECOME A MEME MASTER</span>
                            </div>
                        </div>

                        <!-- Magical particles -->
                        <div class="absolute inset-0">
                            <div class="absolute top-1/2 left-4 w-2 h-2 bg-blue-400/50 rounded-full opacity-0 group-hover:opacity-100 group-hover:-translate-y-full transition-all duration-1000"></div>
                            <div class="absolute bottom-1/2 right-4 w-2 h-2 bg-blue-400/50 rounded-full opacity-0 group-hover:opacity-100 group-hover:translate-y-full transition-all duration-1000 delay-300"></div>
                        </div>
                    </a>
                    <!-- Friends Page Button -->
                    <a href="/friends/page" class="group relative bg-black/50 text-white font-bold py-10 px-12 rounded-2xl flex items-center justify-center transform transition-all duration-500 hover:scale-110 overflow-hidden">
                        <!-- Floating sparkles -->
                        <div class="absolute -top-4 left-1/4 w-4 h-4 bg-pink-500 rounded-full blur-sm animate-sparkle"></div>
                        <div class="absolute -bottom-4 right-1/4 w-4 h-4 bg-cyan-400 rounded-full blur-sm animate-sparkle" style="animation-delay: 0.3s;"></div>

                        <!-- Content -->
                        <div class="relative flex items-center space-x-6">
                            <i class="fas fa-user-friends text-5xl text-pink-400 group-hover:animate-pulse3D"></i>
                            <div>
                                <span class="block text-3xl font-black tracking-wider bg-gradient-to-r from-pink-400 to-cyan-400 bg-clip-text text-transparent">FRIENDS</span>
                                <span class="text-sm text-pink-400 tracking-widest">CONNECT & BATTLE</span>
                            </div>
                        </div>

                        <!-- Glow effect -->
                        <div class="absolute inset-0 bg-gradient-to-r from-pink-500/0 via-pink-500/20 to-cyan-400/0 opacity-0 group-hover:opacity-100 transition-all duration-1000"></div>
                    </a>

                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const bell = document.getElementById('notificationBell');
    const dropdown = document.getElementById('notificationDropdown');
    const dot = document.getElementById('notificationDot');
    const list = document.getElementById('notificationList');
  
    async function loadNotifications() {
      const res = await fetch('/notifications/api');
      const data = await res.json();
  
      list.innerHTML = '';
      if (data.notifications.length === 0) {
        list.innerHTML = '<div class="p-3 text-gray-400">No notifications yet.</div>';
        dot.classList.add('hidden');
        return;
      }
  
      let hasUnread = false;
  
      data.notifications.forEach(n => {
        const item = document.createElement('a');
        item.className = `block p-3 hover:bg-purple-800/30 transition ${n.is_read ? 'text-gray-300' : 'text-white font-semibold'}`;
        item.href = getNotificationUrl(n);
        item.target = '_blank';
        item.innerText = n.message;
  
        list.appendChild(item);
        if (!n.is_read) hasUnread = true;
      });
  
      dot.classList.toggle('hidden', !hasUnread);
    }
  
    function getNotificationUrl(n) {
      switch (n.type) {
        case 'star_meme':
          return '/profile';
        case 'friend_request':
          return '/friends/page';
        default:
          return '/';
      }
    }
  
    bell?.addEventListener('click', async () => {
      dropdown.classList.toggle('hidden');
  
      if (!dropdown.classList.contains('hidden')) {
        await loadNotifications();
        await fetch('/notifications/mark-read', { method: 'POST' });
        dot.classList.add('hidden');
      }
    });
  
    // ðŸ”„ Periodic poll for unread notifications
    setInterval(async () => {
      const res = await fetch('/notifications/api');
      const data = await res.json();
      const hasUnread = data.notifications.some(n => !n.is_read);
      dot.classList.toggle('hidden', !hasUnread);
    }, 30000);
  </script>
  
  <!-- ðŸ”´ Phase 4 red dot reveal (server-rendered fallback) -->
  <% if (typeof unreadCount !== 'undefined' && unreadCount > 0) { %>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('notificationDot')?.classList.remove('hidden');
      });
    </script>
  <% } %>
  
  
  
  